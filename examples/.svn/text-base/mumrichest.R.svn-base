library(richest)
dataDir = "~/tmp/MUM/richest_input/sample01"
graphOutput = 'sample01.pdf'
method = "Lijou"

inputfiles = list.files(dataDir,recursive=TRUE,pattern=".list")
cps_list = sapply(file.path(dataDir,inputfiles),readCPS)
richest_list = list()
for(smpl in names(cps_list)) {
  richest_list[[smpl]] = richest(cps_list[[smpl]],seq(1,10000,25),method)
}
names(richest_list) = sapply(names(richest_list),function(x) gsub('^.+/(.+).list$',"\\1",x))

ymax = max(sapply(richest_list,function(x) {max(x@estimates,na.rm=TRUE)}))
xmax = max(sapply(richest_list,function(x) {max(x@sampleSizes,na.rm=TRUE)}))
pdf(graphOutput)
plot(richest_list[[1]],type="l",lty=1,xlim=c(0,xmax),ylim=c(0,ymax))
labels = names(richest_list)[1]
for(smpl in names(richest_list)[2:length(richest_list)]) {
  points(richest_list[[smpl]],type="l",lty=1)
  labels = c(labels,smpl)
}
legend('bottomright',lty=c(1,2,3),legend=labels)
dev.off()
